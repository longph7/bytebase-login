<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="../../../vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHub OAuth 回调处理中...</title>
    <script>
      /**
       * GitHub OAuth 回调处理页面
       * 将 OAuth 回调重定向到主应用页面，并保留查询参数
       */
      (function() {
        console.log('GitHub OAuth 回调页面加载');
        console.log('当前 URL:', window.location.href);
        
        // 获取当前 URL 的查询参数
        var search = window.location.search;
        console.log('查询参数:', search);
        
        // 根据环境确定目标路径
        var isLocalhost = window.location.hostname === 'localhost';
        var targetPath = isLocalhost ? '/' : '/bytebase-login/';
        var redirectUrl = window.location.origin + targetPath + search;
        
        console.log('重定向到:', redirectUrl);
        
        // 立即重定向到主应用页面
        window.location.replace(redirectUrl);
      })();
    </script>
  </head>
  <body>
    <div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
      <div style="text-align: center;">
        <div style="font-size: 18px; color: #666; margin-bottom: 10px;">
          正在处理 GitHub 登录...
        </div>
        <div style="font-size: 14px; color: #999;">
          如果页面没有自动跳转，请手动刷新页面
        </div>
      </div>
    </div>
    
    <script>
      // 备用重定向方案，防止主脚本失败
      setTimeout(function() {
        console.log('备用重定向方案触发');
        var isLocalhost = window.location.hostname === 'localhost';
        var targetPath = isLocalhost ? '/' : '/bytebase-login/';
        var redirectUrl = window.location.origin + targetPath + window.location.search;
        console.log('备用重定向到:', redirectUrl);
        window.location.href = redirectUrl;
      }, 2000);
    </script>
  </body>
</html>